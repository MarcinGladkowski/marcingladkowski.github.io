{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/bash-training-2/",
    "result": {"data":{"site":{"siteMetadata":{"title":"Think Big"}},"markdownRemark":{"id":"c2b8869c-e083-5893-a207-696ba7ac4b95","excerpt":"Słowem wstępu W tym wpisie skupię się na możliwościach skryptów powłoki Bash, bezpieczeństwie i dobrych praktykach tworzenia skryptów. Oczywiście temat nie…","html":"<h3>Słowem wstępu</h3>\n<p>W tym wpisie skupię się na możliwościach skryptów powłoki Bash, bezpieczeństwie i dobrych praktykach tworzenia skryptów.</p>\n<p>Oczywiście temat nie będzie prze zemnie wyczerpany, a jest jedynie podstawą dla początkujących tak aby tworzyć wystarczająco dobre skrypty oraz zapobiec pewnym powszechnym błędom.</p>\n<p>W moim repozytoium <a href=\"https://github.com/MarcinGladkowski/bash-training\">bash_training</a> są podstawowe skrypty gdzie zapoznawałem się składnią języka.</p>\n<h3>Bezpieczeństwo</h3>\n<h4>Przytoczę najważniejsze zasady działania z różnymi skryptami, w momencie gdy mamy coś zrobić przy ich pomocy:</h4>\n<ul>\n<li>Musisz być ostrożnym co wykonujesz!</li>\n<li>Nie uruchamiaj wszystkiego z uprawnieniami <strong>root</strong></li>\n<li>Dodaj <em>alias</em> na komendy systemowe, ktore mogą narobić najwięcej szkód! (np: alias=‘rm -i’)</li>\n<li>Jest wiele możliwości ataku! - nie uruchamiaj skryptów o dziwnej dla Ciebie zawartości</li>\n</ul>\n<h3>Jak napisać wystarczająco dobry skrypt powłoki ?</h3>\n<p>Należy pamiętać, że dobrze napisany skrypt urchoni nas przed problemami. Gdy zrobimy to niedbale możemy stracić ważne dla nas pliki czy uszkodzić nasz system. Mniejszy problem, gdy będzie to tylko nasze lokalne środowisko.</p>\n<p>Rady opisane poniżej będą zaczerpnięte z wpisu na blogu <a href=\"https://devopsiarz.pl/bash/tutorial-kurs-pisania-dobrych-skryptow-bash-wstep-dobre-praktyki-shellcheck/\">https://devopsiarz.pl - wpis</a>.</p>\n<p>Po napisaniu własnego skryptu warto użyć narzędzia do sprawdzenia poprawności składni i potencjalnych problemów. Polecane jest narzędzie <strong>shellcheck</strong>. Do instalacji na <em>Ubuntu</em> wystarczy użyć standardowego managera paczek <code class=\"language-text\">sudo apt-get install -y shellcheck</code></p>\n<p>Użyjemy tego narzędzia do analizy skryptu, którego napisałem ostatnii na potrzeby dodawania nowego pliku z wpisem dla Jeckyll.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/bin/bash</span>\n\n<span class=\"token assign-left variable\">POSTS_DIR</span><span class=\"token operator\">=</span><span class=\"token string\">\"<span class=\"token variable\">${<span class=\"token environment constant\">PWD</span>}</span>/_posts/\"</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Create new post\"</span>\n<span class=\"token assign-left variable\">date</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">date</span> <span class=\"token string\">'+%Y-%m-%d'</span><span class=\"token variable\">)</span></span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Default time for post is <span class=\"token variable\">$date</span>\"</span>\n\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Set title of post\"</span>\n<span class=\"token builtin class-name\">read</span> title <span class=\"token comment\"># find idea to get title (set maximum arguments)</span>\n<span class=\"token comment\"># parse setting -</span>\n<span class=\"token assign-left variable\">postFile</span><span class=\"token operator\">=</span><span class=\"token string\">\"<span class=\"token variable\">$date</span>-<span class=\"token variable\">${title<span class=\"token operator\">/</span> <span class=\"token operator\">/</span>-}</span>.md\"</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> -f <span class=\"token variable\">$postFile</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n   <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Post with name <span class=\"token variable\">$postFile</span> exists!\"</span>\n   <span class=\"token comment\"># want to delete ?</span>\n<span class=\"token keyword\">fi</span>\n\n<span class=\"token assign-left variable\">NEW_POST_FILE</span><span class=\"token operator\">=</span><span class=\"token string\">\"<span class=\"token variable\">${POSTS_DIR}</span><span class=\"token variable\">${postFile}</span>\"</span>\n\n<span class=\"token function\">touch</span> <span class=\"token string\">\"<span class=\"token variable\">${POSTS_DIR}</span><span class=\"token variable\">${postFile}</span>\"</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Created new post! <span class=\"token variable\">${postFile}</span>\"</span>\n\n<span class=\"token function\">tee</span> -a <span class=\"token variable\">${NEW_POST_FILE}</span> <span class=\"token operator\">&lt;&lt;</span><span class=\"token string\">HEADERS\n---\nlayout: default\ntitle: <span class=\"token variable\">${title}</span>\n---\nHEADERS</span></code></pre></div>\n<p>Wykonajmy teraz analizę przy pomocy <code class=\"language-text\">shellcheck</code> wykonując komendę: <code class=\"language-text\">shellcheck ./scripts/newPost.sh</code></p>\n<p>Output w wierszu poleceń:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">read</span> title <span class=\"token comment\"># find idea to get title (set maximum arguments)</span>\n^--^ SC2162: <span class=\"token builtin class-name\">read</span> without -r will mangle backslashes.\n\n\nIn ./scripts/newPost.sh line <span class=\"token number\">13</span>:\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> -f <span class=\"token variable\">$postFile</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n        ^-------^ SC2086: Double quote to prevent globbing and word splitting.\n\nDid you mean:\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> -f <span class=\"token string\">\"<span class=\"token variable\">$postFile</span>\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n\n\nIn ./scripts/newPost.sh line <span class=\"token number\">23</span>:\n<span class=\"token function\">tee</span> -a <span class=\"token variable\">${NEW_POST_FILE}</span> <span class=\"token operator\">&lt;&lt;</span>HEADERS\n       ^--------------^ SC2086: Double quote to prevent globbing and word splitting.\n\nDid you mean:\n<span class=\"token function\">tee</span> -a <span class=\"token string\">\"<span class=\"token variable\">${NEW_POST_FILE}</span>\"</span> <span class=\"token operator\">&lt;&lt;</span>HEADERS\n\nFor <span class=\"token function\">more</span> information:\n  https://www.shellcheck.net/wiki/SC2086 -- Double quote to prevent globbing <span class=\"token punctuation\">..</span>.\n  https://www.shellcheck.net/wiki/SC2162 -- <span class=\"token builtin class-name\">read</span> without -r will mangle backs<span class=\"token punctuation\">..</span>.</code></pre></div>\n<p>Z powyższej analizy wystarczy, że jeśli dodamy cudzysłów w dwóch miejscach i parametr <code class=\"language-text\">-r</code> do odczytywania inputu możemy poprawić działanie skryptu. Oczywiście to jednak trochę za mało.</p>\n<p>Z przyzwyczajenia często używałem zapisu zmiennych z postaci <code class=\"language-text\">postFile</code>, ale z tego co widzę lepiej z wygląda zapis w postaci <code class=\"language-text\">POST_FILE</code> lub <code class=\"language-text\">post_file</code>.</p>\n<p>Z przytoczonego prze ze mnie wpisu można jednak wyciągnąć dużo więcej.</p>\n<p>Jako, że nigdy nie pisałem za dużo skryptów <code class=\"language-text\">Bash</code> można się jeszcze dużo nauczyć.</p>\n<p>Czego można by jeszcze opisać i nauczyć się, a jest jeszcze sporo tego. Mimo, że jest XXI skrypty <code class=\"language-text\">Bash</code> można spotkać wszędzie np. gdy tworzysz np swój obraz dokera w <code class=\"language-text\">Dockerfile</code>.</p>\n<p>Co chciałym jeszcze opisać:</p>\n<ul>\n<li>Jak tworzyć odpowiednie warunki.</li>\n<li>Sprawdznie odpowiednich oprawnień.</li>\n<li>Tworzenie odpowiedniego skryptu z parametrami przy użyciu <code class=\"language-text\">getopt</code>.</li>\n<li>Kody błędów oraz zwracanie ich, obsługa błędów.</li>\n</ul>\n<p>Pozdrawiam\nMarcin</p>","frontmatter":{"title":"Bash training 2","date":"May 31, 2020","description":null}},"previous":{"fields":{"slug":"/bash-training/"},"frontmatter":{"title":"Bash training"}},"next":{"fields":{"slug":"/summary-2020-plans-for-2021/"},"frontmatter":{"title":"Summary 2020 - plans for 2021"}}},"pageContext":{"id":"c2b8869c-e083-5893-a207-696ba7ac4b95","previousPostId":"080fb369-d42b-58e7-ad9f-898513eb3106","nextPostId":"c8b91571-9e6a-5cf8-a7bb-563da5fe9e13"}},
    "staticQueryHashes": ["4135132960","805692932"]}