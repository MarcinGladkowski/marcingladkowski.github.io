{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/clean-code-workshop/",
    "result": {"data":{"site":{"siteMetadata":{"title":"Think Big","siteUrl":"https://marcingladkowski.pl"}},"markdownRemark":{"id":"5ac51126-3fc8-556b-8b5f-87e7f68bb632","excerpt":"At the 13Th of December I participated in Clean Code and Architecture workshops done by Docplanner. Yep, very relevant topic\nfor each developer. The practicing…","html":"<p>At the 13Th of December I participated in Clean Code and Architecture workshops done by Docplanner. Yep, very relevant topic\nfor each developer. The practicing of writing the clean code is the one of most grateful think for you, colic and your business.\nThe clean code allows you to make easy changes, maintainable things which you have time to forget. This is the skill to practicing\nevery day.</p>\n<p>Let’s focus on workshop. The repository which was prepared by <strong>Docplanner Tech</strong> you can find <a href=\"https://github.com/MarcinGladkowski/clean-code-architecture\">here</a></p>\n<p>Let’s focus on content!</p>\n<h1>Object calisthenics</h1>\n<p>To get more knowledge about that I found a great blog post of <strong>Willam Durand</strong> -> <a href=\"https://williamdurand.fr/2013/06/03/object-calisthenics/\">here</a>\nEach rule looks great, but using it can be more complicate.</p>\n<p>In the shortest way. It’s about follow to 9 rules:</p>\n<ol>\n<li>Only One Level Of Indentation Per Method</li>\n<li>Don’t Use The ELSE Keyword</li>\n<li>Wrap All Primitives And Strings</li>\n<li>First Class Collections</li>\n<li>One Dot Per Line</li>\n<li>Don’t Abbreviate</li>\n<li>Keep All Entities Small</li>\n<li>No Classes With More Than Two Instance Variables</li>\n<li>No Getters/Setters/Properties</li>\n</ol>\n<p>Below I described some examples of providing some of these rules on workshop and this test project.</p>\n<h3>Only One Level Of Indentation Per Method</h3>\n<p>It’s a great advises except SOLID, KISS etc. I always try to avoid to many levels and <strong>indentation</strong> and\nusing <strong>else</strong> block.</p>\n<p>Too long methods and functions are not a very simple and clear to read. We should to try to extract block of codes to\nsimple methods. Looks simple but there is a lot of patterns of refactoring like <strong>extract function</strong> from <a href=\"https://refactoring.com/\">Refactoring Book</a>\n(Martin Fowler).</p>\n<p><em>Pro tip: If you are using PhpStorm there is shortcut to <a href=\"https://www.jetbrains.com/help/phpstorm/extract-method.html\">extract code as function</a></em></p>\n<p>Commit: <a href=\"https://github.com/docplanner-workshop/clean-code-architecture/commit/acb1aea47fdbb802b2717b0c249ff6bcbeebedd5\">acb1aea</a>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 569px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 157.59493670886076%; position: relative; bottom: 0; left: 0; background-image: url('data:image/webp;base64,UklGRnwAAABXRUJQVlA4IHAAAAAQBQCdASoUACAAPtFcqU2oJSQmKAqpABoJZQDE+P8BnduCXpOaqY9mmO/Zvt8m4lNwAP706/WNRN0VEghl5RjEAsoJexv3RsjFeSxCAJDREq7ez7I97eOyLAwGStRc9T7LLq5aMgZo3LaAOtu294AA'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"diff_3\"\n        title=\"diff_3\"\n        src=\"/static/220475983d0a56780bd9fdb586e4a2d8/854dc/diff_3.png\"\n        srcset=\"/static/220475983d0a56780bd9fdb586e4a2d8/c26ae/diff_3.png 158w,\n/static/220475983d0a56780bd9fdb586e4a2d8/6bdcf/diff_3.png 315w,\n/static/220475983d0a56780bd9fdb586e4a2d8/854dc/diff_3.png 569w\"\n        sizes=\"(max-width: 569px) 100vw, 569px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3>Don’t Use The ELSE Keyword</h3>\n<p>This simple change cam simplify a code to read and testing it. Less cyclomatic and cognitive complexity.\nBut we don’t forget about <em>return</em> statement, because this technique allows us to safely execute code.</p>\n<p>Commit: <a href=\"https://github.com/docplanner-workshop/clean-code-architecture/commit/a566791fb121bc6469447a5ae400e682fe5a6bab\">a566791</a>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 591px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 99.36708860759494%; position: relative; bottom: 0; left: 0; background-image: url('data:image/webp;base64,UklGRlYAAABXRUJQVlA4IEoAAACQAwCdASoUABQAPtFcqE4oJSQiKAqpABoJZ2p9ABvz2c8zCfkAAP7xOMIbA4rP3/vogj/gmic+EmnqR54D5Np5bWgFJB7BIAAAAA=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"diff_2\"\n        title=\"diff_2\"\n        src=\"/static/83d1231b211c82617e1b824e1f34253f/e4c9a/diff_2.png\"\n        srcset=\"/static/83d1231b211c82617e1b824e1f34253f/c26ae/diff_2.png 158w,\n/static/83d1231b211c82617e1b824e1f34253f/6bdcf/diff_2.png 315w,\n/static/83d1231b211c82617e1b824e1f34253f/e4c9a/diff_2.png 591w\"\n        sizes=\"(max-width: 591px) 100vw, 591px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>Another example of this technique. It’s mean to fast quit from method when relevant data are missing.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">doSomething</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$params</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">?</span><span class=\"token class-name return-type\">someType</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">empty</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$params</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token constant\">null</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>Don’t Abbreviate</h3>\n<p>Using a meaningful variables names can be very helpful. What’s we have done with code:\n<a href=\"https://github.com/docplanner-workshop/clean-code-architecture/commit/0d1b74f3cb706a98f870421bba34061bcf5b1def?branch=0d1b74f3cb706a98f870421bba34061bcf5b1def&#x26;diff=unified\">0d1b74f</a>\n<a href=\"https://github.com/docplanner-workshop/clean-code-architecture/commit/120a26ed7d1da0a31a983341419d2560b09ac52a?branch=120a26ed7d1da0a31a983341419d2560b09ac52a&#x26;diff=unified\">120a26e</a></p>\n<p>Meaningful names changes a readability a lot:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 560px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/30ad31f500f906bf25a97b1381cc2c9b/b06ae/diff_1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 120.25316455696202%; position: relative; bottom: 0; left: 0; background-image: url('data:image/webp;base64,UklGRmgAAABXRUJQVlA4IFwAAABwBACdASoUABgAPtFepU6oJSMiKAqpABoJaQDN/BEz1f65XJO5hA853FgKqAD+9PUDJOo9C6L3xAWTeEDtS7umrMThDa8jvzfRobZpG9tEDqo3UOuyeA6qNYAAAA=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"diff_1\"\n        title=\"diff_1\"\n        src=\"/static/30ad31f500f906bf25a97b1381cc2c9b/b06ae/diff_1.png\"\n        srcset=\"/static/30ad31f500f906bf25a97b1381cc2c9b/c26ae/diff_1.png 158w,\n/static/30ad31f500f906bf25a97b1381cc2c9b/6bdcf/diff_1.png 315w,\n/static/30ad31f500f906bf25a97b1381cc2c9b/b06ae/diff_1.png 560w\"\n        sizes=\"(max-width: 560px) 100vw, 560px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h3>Wrap All Primitives And Strings</h3>\n<p>When I heard this my first thought was - Value Object. The convention of <a href=\"https://martinfowler.com/bliki/ValueObject.html\">Value Object</a> comes from DDD (Domain Driven Design) techniques. Shortly, It’s about to wrap meaningful values - usually they can be store in primitive values.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token keyword\">declare</span><span class=\"token punctuation\">(</span>strict_types<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">namespace</span> <span class=\"token package\">App<span class=\"token punctuation\">\\</span>Model</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Specialization</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword type-declaration\">string</span> <span class=\"token variable\">$name</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token keyword type-hint\">string</span> <span class=\"token variable\">$name</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">name</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$name</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n     <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">name</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword return-type\">string</span>\n     <span class=\"token punctuation\">{</span>\n         <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">name</span><span class=\"token punctuation\">;</span>\n     <span class=\"token punctuation\">}</span>\n\n     <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">equals</span><span class=\"token punctuation\">(</span><span class=\"token class-name type-declaration\">Specialization</span> <span class=\"token variable\">$specialization</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword return-type\">bool</span>\n     <span class=\"token punctuation\">{</span>\n         <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">name</span> <span class=\"token operator\">===</span> <span class=\"token variable\">$specialization</span><span class=\"token operator\">-></span><span class=\"token function\">name</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n     <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></span></code></pre></div>\n<h3>No Getters/Setters/Properties</h3>\n<p>Since I trying to create immutable objects like <strong>VO</strong> there are any getters and setters. The state is usually\npassing by <em>__constructor</em>. The same thing is about to <em>wrapping all primitives</em>. We can follow this rule by using DTOs.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Doctor</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword type-declaration\">string</span> <span class=\"token variable\">$firstName</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword type-declaration\">string</span> <span class=\"token variable\">$lastName</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name type-declaration\">Specialization</span> <span class=\"token variable\">$specialization</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token keyword type-hint\">string</span> <span class=\"token variable\">$firstName</span><span class=\"token punctuation\">,</span> <span class=\"token keyword type-hint\">string</span> <span class=\"token variable\">$lastName</span><span class=\"token punctuation\">,</span> <span class=\"token class-name type-declaration\">Specialization</span> <span class=\"token variable\">$specialization</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">firstName</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$firstName</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">lastName</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$lastName</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">specialization</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$specialization</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">firstName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword return-type\">string</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">firstName</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">lastName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword return-type\">string</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">lastName</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">specialization</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token class-name return-type\">Specialization</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">specialization</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Some rules can be hard to follow them for example this one about <em>only two instance variables</em>. Usually in bigger project exist specialized services\ndoing to much things (the SRP - Single Responsibility Rule is break also) with a lot of some dependencies.</p>\n<h1>Architecture</h1>\n<p>I am sure, all web developers knows at least one architecture pattern MVC (Model-View-Controller). When I write my first\ncode as a Junior developer I pasted a lot of code to controllers. I think a lot of developers made mistake like this.\nIf you get some knowledge and experience, you will see the bad side of this solution. In my opinion each should meet this\nproblem to saw what’s wrong with this architecture. I don’t say it’s bad patters but have some limitations. Many of developers\ncannot have idea <em>where should I put this code?</em> because they have only three official layers: <em>model, controller, view</em>.\nWhat’s the most dangerous to put all logic code into controller? Then developers put business logic also to controller,\nmodel and view!. Developing in this way makes a lot off mess in our code and if we want to apply some little change\nwe have to look it very careful! The code isn’t reusable.</p>\n<p>What we can do in this case ?</p>\n<p>I hope you heard about <strong>SOLID</strong> principles. These rules are independent from programming languages. Only interesting thing is\nthis is the most popular requirement question for programmer. If you don’t know this rules, hurry up! You should memorize it.</p>\n<p>Using SRP (Single Responsibility Principle) and DI (Dependency Inversion) we can easily decouple our logic and relation between\nclasses.</p>\n<p>Some steps of refactoring to make our code clean:</p>\n<ul>\n<li>Moving methods to external class (service)</li>\n<li>Not using lower level dependencies in a service</li>\n<li>Depend in Abstractions, not on implementations (ex. create and interface)</li>\n<li>Moving out Request handling out of the Controller</li>\n<li>Entities refactoring (no getters/setters, guard invariants (valid domain state)…)</li>\n</ul>\n<p>Look at this example controller, please. Looks good, but can we do better ?</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Controller</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">AbstractController</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">index</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">JsonResponse</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'ReallyDirty API v1.0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">/**\n     * @Route(\"/doctor\", methods={\"POST\"})\n     * @param Request $request\n     * @return JsonResponse\n     */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">addDoctorAction</span><span class=\"token punctuation\">(</span><span class=\"token class-name type-declaration\">Request</span> <span class=\"token variable\">$request</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$doctor</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token function\">createDoctorFromRequest</span><span class=\"token punctuation\">(</span>\n            <span class=\"token variable\">$request</span><span class=\"token operator\">-></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'firstName'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token variable\">$request</span><span class=\"token operator\">-></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'lastName'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token variable\">$request</span><span class=\"token operator\">-></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'specialization'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$doctor</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">JsonResponse</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'id'</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$doctor</span><span class=\"token operator\">-></span><span class=\"token function\">getId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">/**\n     * @Route(\"/doctor\", methods={\"GET\"})\n     * @param Request $request\n     * @return JsonResponse\n     */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">getDoctorAction</span><span class=\"token punctuation\">(</span><span class=\"token class-name type-declaration\">Request</span> <span class=\"token variable\">$request</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$doctor</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token function\">getDoctor</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$request</span><span class=\"token operator\">-></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'id'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token variable\">$doctor</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">JsonResponse</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">404</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">JsonResponse</span><span class=\"token punctuation\">(</span>\n            <span class=\"token punctuation\">[</span>\n                <span class=\"token string single-quoted-string\">'id'</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$doctor</span><span class=\"token operator\">-></span><span class=\"token function\">getId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string single-quoted-string\">'firstName'</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$doctor</span><span class=\"token operator\">-></span><span class=\"token function\">getFirstName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string single-quoted-string\">'lastName'</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$doctor</span><span class=\"token operator\">-></span><span class=\"token function\">getLastName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string single-quoted-string\">'specialization'</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$doctor</span><span class=\"token operator\">-></span><span class=\"token function\">getSpecialization</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// and more and more...</span></code></pre></div>\n<p>What the cons of this solution:</p>\n<ul>\n<li>If have a lot of endpoints it can be verrryy long class (thousands lines of code…)</li>\n<li>The controller depends of Request class.</li>\n<li>We have to decide which type response we want JSON, XML or something else.</li>\n<li>We have to parse incoming data, but maybe it not only from HTTP request ?</li>\n</ul>\n<p>There is a time for <strong>Action Domain Responder</strong></p>\n<p>This architecture pattern is quite new for me and was I found it isn’t very old (like MVC - 1979).\nBut great to get new knowledge about architecture. Invited and described by <a href=\"http://paul-m-jones.com/\">Paul M. Jones</a>\nin 2014 using <strong>PHP</strong>! oh yeah!</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 528px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c7220b06b32003e6713307713bb26d22/4af8e/adr.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.708860759493675%; position: relative; bottom: 0; left: 0; background-image: url('data:image/webp;base64,UklGRkYAAABXRUJQVlA4IDoAAACwAwCdASoUAAcAPtFWpEuoJKOhsAgBABoJaQAAXK/nY7qV+PTrAAD+9hEUQxcE32LqBjDYjOqsMAAA'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"adr\"\n        title=\"adr\"\n        src=\"/static/c7220b06b32003e6713307713bb26d22/4af8e/adr.png\"\n        srcset=\"/static/c7220b06b32003e6713307713bb26d22/c26ae/adr.png 158w,\n/static/c7220b06b32003e6713307713bb26d22/6bdcf/adr.png 315w,\n/static/c7220b06b32003e6713307713bb26d22/4af8e/adr.png 528w\"\n        sizes=\"(max-width: 528px) 100vw, 528px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\nAnd the MVC pattern\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/35deb37d4147917f77b7b68ee9358fe5/13a9a/mvc.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.26582278481012%; position: relative; bottom: 0; left: 0; background-image: url('data:image/webp;base64,UklGRkoAAABXRUJQVlA4ID4AAACQAwCdASoUAAoAPtFWo0uoJKMhsAgBABoJaQAAXK+4oBzomDAAAP71IibhX6vItpgz7/n5nCx6ThqoniAAAA=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"mvc\"\n        title=\"mvc\"\n        src=\"/static/35deb37d4147917f77b7b68ee9358fe5/f058b/mvc.png\"\n        srcset=\"/static/35deb37d4147917f77b7b68ee9358fe5/c26ae/mvc.png 158w,\n/static/35deb37d4147917f77b7b68ee9358fe5/6bdcf/mvc.png 315w,\n/static/35deb37d4147917f77b7b68ee9358fe5/f058b/mvc.png 630w,\n/static/35deb37d4147917f77b7b68ee9358fe5/13a9a/mvc.png 637w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>I am not a super expert in Symfony framework but some Docplanner created a blog post about\nimplementation ADR <a href=\"https://medium.com/swlh/implementing-action-domain-responder-pattern-with-symfony-606539eea3a7\">here</a></p>\n<p>But the main core of ADR is above. The main action class has a dependency injection with are <em>Doctors</em> and <em>DoctorFactory</em>.\nFocus on remember to using <em>interfaces</em>. The one thing is strictly tie with framework is an this <em>annotation</em>.\nThis action looks very clear, the input and output are specified DTO classes.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 569px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2a2193cac7f6a7277975d49e771e51e7/854dc/add_doctor_action.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 144.9367088607595%; position: relative; bottom: 0; left: 0; background-image: url('data:image/webp;base64,UklGRoQAAABXRUJQVlA4WAoAAAAQAAAAEwAAHAAAQUxQSBgAAAABFyAQSPwRk3mNiIgDIUHCePebI/of0AtWUDggRgAAAFADAJ0BKhQAHQA+0VqkTSglIyIwGAgBABoJZ2sJW9eJ2AMwAP7wIqhFz/af6y8X6SDjE3Gf37S/QQIxgTqWtVqTBayAAAA='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"add_doctor_action\"\n        title=\"add_doctor_action\"\n        src=\"/static/2a2193cac7f6a7277975d49e771e51e7/854dc/add_doctor_action.png\"\n        srcset=\"/static/2a2193cac7f6a7277975d49e771e51e7/c26ae/add_doctor_action.png 158w,\n/static/2a2193cac7f6a7277975d49e771e51e7/6bdcf/add_doctor_action.png 315w,\n/static/2a2193cac7f6a7277975d49e771e51e7/854dc/add_doctor_action.png 569w\"\n        sizes=\"(max-width: 569px) 100vw, 569px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\nDTO of input.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token keyword\">declare</span><span class=\"token punctuation\">(</span>strict_types<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">namespace</span> <span class=\"token package\">App<span class=\"token punctuation\">\\</span>Action<span class=\"token punctuation\">\\</span>Input</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">use</span> <span class=\"token package\">Symfony<span class=\"token punctuation\">\\</span>Component<span class=\"token punctuation\">\\</span>Validator<span class=\"token punctuation\">\\</span>Constraints</span> <span class=\"token keyword\">as</span> Assert<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">AddDoctorInput</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">/**\n     * @Assert\\NotBlank()\n     * @var string\n     */</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword type-declaration\">string</span> <span class=\"token variable\">$firstName</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">/**\n     * @Assert\\NotBlank()\n     * @var string\n     */</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword type-declaration\">string</span> <span class=\"token variable\">$lastName</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword type-declaration\">string</span> <span class=\"token variable\">$specialisation</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token keyword type-hint\">string</span> <span class=\"token variable\">$firstName</span><span class=\"token punctuation\">,</span> <span class=\"token keyword type-hint\">string</span> <span class=\"token variable\">$lastName</span><span class=\"token punctuation\">,</span> <span class=\"token keyword type-hint\">string</span> <span class=\"token variable\">$specialisation</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">firstName</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$firstName</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">lastName</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$lastName</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">specialisation</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$specialisation</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">getFirstName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword return-type\">string</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">firstName</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">getLastName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword return-type\">string</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">lastName</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">getSpecialisation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword return-type\">string</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">specialisation</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></span></code></pre></div>\n<p>Dto of output. Very simple to use it to make an system response in each kind of: JSON, XML etc.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token keyword\">declare</span><span class=\"token punctuation\">(</span>strict_types<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">namespace</span> <span class=\"token package\">App<span class=\"token punctuation\">\\</span>Action<span class=\"token punctuation\">\\</span>Output</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">AddDoctorOutput</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword type-declaration\">int</span> <span class=\"token variable\">$id</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token keyword type-hint\">int</span> <span class=\"token variable\">$id</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">id</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$id</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">getId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword return-type\">int</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">id</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></span></code></pre></div>\n<p>How look controller now ? You have right - it’s not necessary.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token keyword\">declare</span><span class=\"token punctuation\">(</span>strict_types<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">namespace</span> <span class=\"token package\">App<span class=\"token punctuation\">\\</span>Controller</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">use</span> <span class=\"token package\">Symfony<span class=\"token punctuation\">\\</span>Bundle<span class=\"token punctuation\">\\</span>FrameworkBundle<span class=\"token punctuation\">\\</span>Controller<span class=\"token punctuation\">\\</span>AbstractController</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">Symfony<span class=\"token punctuation\">\\</span>Component<span class=\"token punctuation\">\\</span>HttpFoundation<span class=\"token punctuation\">\\</span>JsonResponse</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Controller</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">AbstractController</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">index</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token class-name return-type\">JsonResponse</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">JsonResponse</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'ReallyDirty API v1.0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></span></code></pre></div>\n<p><em>This post is a some shortcut to memorize these things.\nIt can looks a little chaotic but it’s first post for 2021.</em></p>\n<p>Full presentation: <a href=\"https://docs.google.com/presentation/d/1RkrPrKNUL1DVmHuRFA6RC5eHPRG0xUiNsZLEfI0CZzw/edit#slide=id.gaeea1ef32b_1_1\">here</a></p>\n<p>The workshop was great! Thanks for all Docplanner team!</p>\n<p><em>Marcin</em></p>","frontmatter":{"title":"Clean Code workshop","date":"January 24, 2021","description":null}},"previous":{"fields":{"slug":"/summary-2020-plans-for-2021/"},"frontmatter":{"title":"Summary 2020 - plans for 2021"}},"next":{"fields":{"slug":"/python-crash-course/"},"frontmatter":{"title":"Python Crash Course (2nd Edition)"}}},"pageContext":{"id":"5ac51126-3fc8-556b-8b5f-87e7f68bb632","previousPostId":"c8b91571-9e6a-5cf8-a7bb-563da5fe9e13","nextPostId":"ca346625-95bd-5494-83af-5d25cdd8d4a7"}},
    "staticQueryHashes": ["4135132960","805692932"]}